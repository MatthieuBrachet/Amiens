clc; clear all; close all;

n=10;
h=1/(n+1);
x=[0:h:1]';
[X,Y]=meshgrid(x,x);
u=reshape(cos(3*pi*X).*cos(pi*Y),[],1);

[a0,M,N] = Mlaplacien2(n,4);
Id=speye(size(N));
M=kron(M,Id)+kron(Id,M);
N=kron(N,Id)+kron(Id,N);

duapp=M\(N*u);
ddu=10*pi^2.*u;

DUe=reshape(ddu,size(X));
DUapp=reshape(duapp,size(X));

e=norm(duapp-ddu,inf)

figure(1)
subplot(121)
surf(X,Y,DUapp);
title('approchee')

subplot(122)
surf(X,Y,DUe);
title('exacte')